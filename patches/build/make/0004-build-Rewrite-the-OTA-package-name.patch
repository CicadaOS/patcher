From 0fcb6869ab0f190ef03e9d83bb32b90cda45b27d Mon Sep 17 00:00:00 2001
From: Adrian DC <radian.dc@gmail.com>
Date: Fri, 21 Apr 2017 19:50:56 +0200
Subject: [PATCH 04/45] build: Rewrite the OTA package name

 * Result example:
    aosp-7.1-20161023-huashan-adriandc.zip

Change-Id: I1e45432d9fe69443def1492956c8405e2c3f2635
Signed-off-by: Adrian DC <radian.dc@gmail.com>
---
 core/Makefile | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/core/Makefile b/core/Makefile
index 66706fc..7c3f874 100644
--- a/core/Makefile
+++ b/core/Makefile
@@ -4204,7 +4204,12 @@ $(INTERNAL_OTA_PACKAGE_TARGET): $(BUILT_TARGET_FILES_PACKAGE) \
 	$(call build-ota-package-target,$@,-k $(KEY_CERT_PAIR) --output_metadata_path $(INTERNAL_OTA_METADATA))
 
 .PHONY: otapackage
+
+TARGET_ROM_PACKAGE := $(PRODUCT_OUT)/aosp-$(PLATFORM_VERSION)-$(shell date +%Y%m%d)-$(TARGET_DEVICE)-$(USER).zip
 otapackage: $(INTERNAL_OTA_PACKAGE_TARGET)
+	   $(hide) ln -f $(INTERNAL_OTA_PACKAGE_TARGET) $(TARGET_ROM_PACKAGE)
+	   $(hide) $(MD5SUM) $(TARGET_ROM_PACKAGE) > $(TARGET_ROM_PACKAGE).md5sum
+	   @echo "OTA Package: " $(TARGET_ROM_PACKAGE) >&2
 
 ifeq ($(BOARD_BUILD_RETROFIT_DYNAMIC_PARTITIONS_OTA_PACKAGE),true)
 name := $(TARGET_PRODUCT)
-- 
2.7.4

