From 369fd58664f5dc569b8cc4893c6d77d42aa9beb3 Mon Sep 17 00:00:00 2001
From: William Bellavance <flintman@flintmancomputers.com>
Date: Tue, 30 Aug 2016 09:28:06 -0400
Subject: [PATCH] selinux: add selinux_status_getenforce to header

Change-Id: I2d6c366b7498d9760cb0bc21bade9b66b20815e9
---
 libselinux/Android.bp                | 2 +-
 libselinux/exported.map              | 1 +
 libselinux/include/selinux/selinux.h | 2 ++
 3 files changed, 4 insertions(+), 1 deletion(-)

diff --git a/libselinux/Android.bp b/libselinux/Android.bp
index 6833cba8..268fc742 100644
--- a/libselinux/Android.bp
+++ b/libselinux/Android.bp
@@ -29,6 +29,7 @@ cc_defaults {
         "src/label.c",
         "src/label_support.c",
         "src/matchpathcon.c",
+        "src/sestatus.c",
         "src/setrans_client.c",
         "src/sha1.c",
     ],
@@ -70,7 +71,6 @@ cc_defaults {
                 "src/policyvers.c",
                 "src/procattr.c",
                 "src/reject_unknown.c",
-                "src/sestatus.c",
                 "src/setenforce.c",
                 "src/setfilecon.c",
                 "src/stringrep.c",
diff --git a/libselinux/exported.map b/libselinux/exported.map
index dd742948..0cf9d96e 100644
--- a/libselinux/exported.map
+++ b/libselinux/exported.map
@@ -37,6 +37,7 @@
     selinux_check_access;
     selinux_log_callback;
     selinux_set_callback;
+    selinux_status_getenforce;
     selinux_status_open;
     selinux_status_updated;
     selinux_vendor_log_callback;
diff --git a/libselinux/include/selinux/selinux.h b/libselinux/include/selinux/selinux.h
index a34d54fc..54b63967 100644
--- a/libselinux/include/selinux/selinux.h
+++ b/libselinux/include/selinux/selinux.h
@@ -10,6 +10,8 @@ extern "C" {
 
 /* Return 1 if we are running on a SELinux kernel, or 0 if not or -1 if we get an error. */
 extern int is_selinux_enabled(void);
+/* Return 1 if we are running on a enforced, or 0 if not or -1 if we get an error. */
+extern int selinux_status_getenforce(void);
 /* Return 1 if we are running on a SELinux MLS kernel, or 0 otherwise. */
 extern int is_selinux_mls_enabled(void);
 
