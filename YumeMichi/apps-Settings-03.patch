From 8838c2c5c8d39f982876076eb6868be2c2d7ea58 Mon Sep 17 00:00:00 2001
From: Bruno Martins <bgcngm@gmail.com>
Date: Tue, 9 Jan 2018 15:41:02 +0000
Subject: [PATCH 3/7] DevelopmentSettings: Hide OEM unlock by default

 * The "OEM unlocking" toogle should not be visible on any
   device running LineageOS, for obvious reasons. Allow it only
   to show up for Google devices, such as Pixel, that set
   ro.oem_unlock_supported=1.

Change-Id: I2b09974fc24e783b985de213b504e964771cbcb7
---
 src/com/android/settings/development/DevelopmentSettings.java | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/src/com/android/settings/development/DevelopmentSettings.java b/src/com/android/settings/development/DevelopmentSettings.java
index 9930443af9..c7d3920689 100644
--- a/src/com/android/settings/development/DevelopmentSettings.java
+++ b/src/com/android/settings/development/DevelopmentSettings.java
@@ -473,7 +473,8 @@ public class DevelopmentSettings extends RestrictedSettingsFragment
         mKeepScreenOn = (RestrictedSwitchPreference) findAndInitSwitchPref(KEEP_SCREEN_ON);
         mBtHciSnoopLog = findAndInitSwitchPref(BT_HCI_SNOOP_LOG);
         mEnableOemUnlock = (RestrictedSwitchPreference) findAndInitSwitchPref(ENABLE_OEM_UNLOCK);
-        if (!showEnableOemUnlockPreference(getActivity())) {
+        if (!showEnableOemUnlockPreference(getActivity()) ||
+                !SystemProperties.getBoolean("ro.oem_unlock_supported", false)) {
             removePreference(mEnableOemUnlock);
             mEnableOemUnlock = null;
         }
-- 
2.11.0.windows.1

